output: default
streamtags: []
groups: {}
asyncFuncTimeout: 1000
functions:
  - id: comment
    filter: "true"
    disabled: null
    conf:
      comment: >-
        NetFlow Normalization Pipeline

        This pipeline normalizes diverse NetFlow field names to a canonical schema
        expected by DeepTempo's Spark ingestion service.

        Canonical Fields:
        - timestamp: Flow start time
        - src_ip / dest_ip: Source and destination IP addresses
        - src_port / dest_port: Source and destination ports
        - fwd_bytes / bwd_bytes: Forward and backward byte counts
        - flow_dur: Flow duration

        The normalization handles variants from Cisco NetFlow, IPFIX, Palo Alto,
        and other common flow exporters.
    description: Pipeline overview and field mapping documentation
  - id: code
    filter: "true"
    disabled: null
    conf:
      maxNumOfIterations: 5000
      activeLogSampleRate: 1
      useUniqueLogChannel: true
      code: |-
        // Normalize Cribl NetFlow fields to DeepTempo canonical schema
        // Cribl NetFlow parser outputs: srcAddr, dstAddr, srcPort, dstPort, octets, durationMs, etc.

        // Map to canonical names
        __e.src_ip = __e.srcAddr;
        __e.dest_ip = __e.dstAddr;
        __e.src_port = __e.srcPort;
        __e.dest_port = __e.dstPort;
        __e.fwd_bytes = __e.octets;
        __e.flow_dur = __e.durationMs;
        __e.timestamp = __e._time;

        // Remove original fields
        delete __e.srcAddr;
        delete __e.dstAddr;
        delete __e.srcPort;
        delete __e.dstPort;
        delete __e.octets;
        delete __e.durationMs;
description: Normalizes NetFlow fields to canonical schema for Spark processing
